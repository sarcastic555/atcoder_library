#!/bin/bash
set -eu

INPUTFILE="${PWD}/input.txt"

g++ test.cpp -o test.out
g++ test2.cpp -o test2.out

while true; do
    echo ${INPUTFILE}
    #source ./random_generator/field_generator.sh ${INPUTFILE}
    #source ./random_generator/string_generator.sh ${INPUTFILE}
    source ./random_generator/integer_array_generator.sh ${INPUTFILE}

    echo "====== show input start ===="
    cat ${INPUTFILE}
    echo "====== show input end ===="
    ./test.out < ${INPUTFILE} > out.txt
    ./test2.out < ${INPUTFILE} > out2.txt
    echo "=== diff output start ==="
    diff -u out.txt out2.txt
    echo "=== diff output end ==="
    diffcount=`diff -u out.txt out2.txt | wc -l`
    if [ $diffcount -ne 0 ]; then
	break
    fi
    sleep 0.1
done
